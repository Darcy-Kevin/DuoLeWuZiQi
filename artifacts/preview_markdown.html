<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>app_email_test.py 测试流程图</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: #ffffff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            margin-top: 36px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 6px;
        }
        .mermaid {
            text-align: center;
            margin: 24px 0;
            background: #fff;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
        }
        ul {
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>app_email_test.py 测试流程图</h1>

        <h2>整体执行流程</h2>
        <div class="mermaid">
flowchart LR
    Start([测试开始]) --> Reset0[停止应用]
    Reset0 --> Launch0[启动应用]
    Launch0 --> Case1[test_email_reddot_and_exit_logic]
    Case1 --> Reset1[停止应用]
    Reset1 --> Launch1[启动应用]
    Launch1 --> Case2[test_email_unread_list_reward_logic]
    Case2 --> Reset2[停止应用]
    Reset2 --> Launch2[启动应用]
    Launch2 --> Case3[test_email_read_list_reward_logic]
    Case3 --> Reset3[停止应用]
    Reset3 --> Launch3[启动应用]
    Launch3 --> Case4[test_email_single_delete_logic]
    Case4 --> Reset4[停止应用]
    Reset4 --> Launch4[启动应用]
    Launch4 --> Case5[test_email_unread_list_one_key_view_logic]
    Case5 --> Reset5[停止应用]
    Reset5 --> Launch5[启动应用]
    Launch5 --> Case6[test_email_read_list_one_key_delete_logic]
    Case6 --> End([测试结束])
        </div>

        <h2>测试邮件红点展示和退场逻辑</h2>
        <div class="mermaid">
flowchart TD
    A[开始] --> B[查找带红点的邮件按钮，阈值1.0]
    B --> C{找到?}
    C -->|是| D[点击邮件按钮]
    C -->|否| E[调用邮件发送接口]
    E --> F[等待5秒]
    F --> G[再次查找红点<br/>阈值0.6→0.45]
    G --> H{找到?}
    H -->|是| D
    H -->|否| Fail1[退出: 红点仍未出现]
    D --> I[验证进入邮件页<br/>查找未读按钮]
    I --> J[点击查看按钮]
    J --> K[验证详情页标题]
    K --> L[点击详情关闭按钮]
    L --> M[点击左上返回按钮]
    M --> N[查找无红点按钮]
    N --> O{找到?}
    O -->|是| Success([成功])
    O -->|否| Fail2[退出: 红点未消失]
        </div>

        <h2>测试未读邮件列表领取邮件奖励</h2>
        <div class="mermaid">
flowchart TD
    A0[开始] --> A1[发送测试邮件请求]
    A1 --> A2[查找邮件按钮并点击]
    A2 --> A3[确认进入未读列表]
    A3 --> A4[目标邮件是否存在?]
    A4 -->|否| FailA[退出: 未找到邮件]
    A4 -->|是| A5[点击查看]
    A5 --> A6[验证详情标题]
    A6 --> A7[点击领取按钮]
    A7 --> A8[查找奖励动画模板]
    A8 --> A9{找到?}
    A9 -->|是| SuccessA([成功])
    A9 -->|否| FailB[退出: 未看到奖励动画]
        </div>

        <h2>test_email_read_list_reward_logic</h2>
        <div class="mermaid">
flowchart TD
    B0[开始] --> B1[进入邮件页]
    B1 --> B2[切换到已读列表]
    B2 --> B3{已读标签存在?}
    B3 -->|否| Fail1[退出: 未进入已读]
    B3 -->|是| B4[选择目标邮件并进入详情]
    B4 --> B5[验证详情标题]
    B5 --> B6[点击领取按钮]
    B6 --> B7[查找奖励动画]
    B7 --> B8{找到?}
    B8 -->|是| SuccessB([成功])
    B8 -->|否| Fail2[退出: 奖励反馈缺失]
        </div>

        <h2>test_email_single_delete_logic</h2>
        <div class="mermaid">
flowchart TD
    C0[开始] --> C1[进入邮件页]
    C1 --> C2[切换至已读列表]
    C2 --> C3[选择红点退场邮件]
    C3 --> C4[进入详情页]
    C4 --> C5[点击删除按钮]
    C5 --> C6[验证二次确认弹窗]
    C6 --> C7[点击确定]
    C7 --> C8[检查邮件标题是否仍存在]
    C8 --> C9{仍存在?}
    C9 -->|是| FailC[退出: 邮件未删除]
    C9 -->|否| SuccessC([成功])
        </div>

        <h2>test_email_unread_list_one_key_view_logic</h2>
        <div class="mermaid">
flowchart TD
    D0[开始] --> D1[循环发送3封测试邮件]
    D1 --> D2[进入邮件页]
    D2 --> D3[确认未读标签存在]
    D3 --> D4[点击一键查看按钮]
    D4 --> D5[查找奖励弹窗模板]
    D5 --> D6{找到奖励?}
    D6 -->|是| SuccessD([成功: 有奖励])
    D6 -->|否| D7[查找空列表图标]
    D7 --> D8{找到空态?}
    D8 -->|是| SuccessE([成功: 空列表])
    D8 -->|否| FailD[退出: 未获取有效反馈]
        </div>

        <h2>test_email_read_list_one_key_delete_logic</h2>
        <div class="mermaid">
flowchart TD
    E0[开始] --> E1[进入邮件页]
    E1 --> E2[切换至已读列表]
    E2 --> E3[点击一键删除按钮]
    E3 --> E4[验证确认弹窗]
    E4 --> E5[点击确定删除]
    E5 --> E6[检查空态图标]
    E6 --> E7{找到?}
    E7 -->|是| SuccessF([成功])
    E7 -->|否| FailE[退出: 邮件仍存在]
        </div>

        <h2>使用提示</h2>
        <ul>
            <li>在浏览器直接打开即可查看所有流程图；如未显示，请检查网络确保能加载 Mermaid.js。</li>
            <li>流程图仅概述关键步骤，细节以测试代码为准。</li>
            <li>建议在更新测试逻辑后同步维护本文件，保持文档与代码一致。</li>
        </ul>
    </div>
</body>
</html>